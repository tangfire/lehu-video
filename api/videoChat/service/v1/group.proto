syntax = "proto3";

package api.videoChat.service.v1;

option go_package = "lehu-video/api/videoChat/service/v1;v1";
option java_multiple_files = true;
option java_package = "api.videoChat.service.v1";
import "api/videoChat/service/v1/base.proto";

service GroupService {
	// 创建群聊
	rpc CreateGroup (CreateGroupReq) returns (CreateGroupResp);

	// 获取我创建的群聊
	rpc LoadMyGroup (LoadMyGroupReq) returns(LoadMyGroupResp);

	// 检查群聊加群方式
	rpc CheckGroupAddMode(CheckGroupAddModeReq) returns(CheckGroupAddModeResp);

	// 直接进群
	rpc EnterGroupDirectly(EnterGroupDirectlyReq) returns(EnterGroupDirectlyResp);

	// 申请加群
	rpc ApplyJoinGroup(ApplyJoinGroupReq) returns(ApplyJoinGroupResp);

	// 退群
	rpc LeaveGroup(LeaveGroupReq) returns(LeaveGroupResp);

	// 解散群聊
	rpc DismissGroup(DismissGroupReq) returns(DismissGroupResp);

	// 获取群聊信息
	rpc GetGroupInfo(GetGroupInfoReq) returns(GetGroupInfoResp);

	// 获取我加入的群聊
	rpc ListMyJoinedGroups(ListMyJoinedGroupsReq) returns(ListMyJoinedGroupsResp);

	// 新增：获取群成员列表
	rpc GetGroupMembers(GetGroupMembersReq) returns (GetGroupMembersResp);

	// 新增：检查是否为群成员
	rpc IsGroupMember(IsGroupMemberReq) returns (IsGroupMemberResp);
}

message GroupInfo {
	string id = 1; // 改为 string
	string name = 2;
	string notice = 3;
	int32 member_cnt = 4;
	string owner_id = 5; // 改为 string
	int32 add_mode = 6;
	string avatar = 7;
	int32 status = 8;
	string created_at = 9;
	string updated_at = 10;
}

message CreateGroupReq {
	string owner_id = 1;
	string name = 2;
	string notice = 3;
	int32 add_mode = 4;
	string avatar = 5;
}

message CreateGroupResp {
	string group_id = 1;
	Metadata meta = 2;
}

message LoadMyGroupReq {
	string owner_id = 1;
	PageStatsReq page_stats = 2;
}

message LoadMyGroupResp {
	repeated GroupInfo groups = 1;
	Metadata meta = 2;
	PageStatsResp page_stats = 3;
}

message CheckGroupAddModeReq {
	string group_id = 1;
}

message CheckGroupAddModeResp {
	int32 add_mode = 1;
	Metadata meta = 2;
}

message EnterGroupDirectlyReq {
	string user_id = 1;
	string group_id = 2;
}

message EnterGroupDirectlyResp {
	Metadata meta = 1;
}

message ApplyJoinGroupReq {
	string user_id = 1;
	string group_id = 2;
	string apply_reason = 3;
}

message ApplyJoinGroupResp {
	Metadata meta = 1;
}

message LeaveGroupReq {
	string user_id = 1;
	string group_id = 2;
}

message LeaveGroupResp {
	Metadata meta = 1;
}

message DismissGroupReq {
	string owner_id = 1;
	string group_id = 2;
}

message DismissGroupResp {
	Metadata meta = 1;
}

message GetGroupInfoReq {
	string group_id = 1;
}

message GetGroupInfoResp {
	GroupInfo group = 1;
	Metadata meta = 2;
}

message ListMyJoinedGroupsReq {
	string user_id = 1;
	PageStatsReq page_stats = 2;
}

message ListMyJoinedGroupsResp {
	repeated GroupInfo groups = 1;
	Metadata meta = 2;
	PageStatsResp page_stats = 3;
}

message GetGroupMembersReq {
	string group_id = 1;
}

message GetGroupMembersResp {
	repeated string member_ids = 1;
	Metadata meta = 2;
}

message IsGroupMemberReq {
	string group_id = 1;
	string user_id = 2;
}

message IsGroupMemberResp {
	bool is_member = 1;
	Metadata meta = 2;
}